<!DOCTYPE html>
<html class="dark" lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>MovieDB - Personal Movie Library</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link href="https://fonts.googleapis.com/css2?family=Spline+Sans:wght@300;400;500;600;700&display=swap"
        rel="stylesheet" />
    <!-- Material Symbols -->
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
        rel="stylesheet" />
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#7f13ec",
                        "primary-hover": "#6b10c6",
                        "secondary": "#EAB308",
                        "background-light": "#f7f6f8",
                        "background-dark": "#191022",
                        "surface-dark": "#241a30",
                        "surface-border": "#3c2f4a",
                        "text-secondary": "#ab9db9",
                        "admin-accent": "#f97316"
                    },
                    fontFamily: {
                        "display": ["Spline Sans", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.25rem",
                        "lg": "0.5rem",
                        "xl": "0.75rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
    <link rel="stylesheet" href="css/styles.css">
</head>

<body
    class="bg-background-light dark:bg-background-dark min-h-screen flex flex-col text-slate-900 dark:text-white overflow-x-hidden">

    <!-- Admin Mode Indicator -->
    <div id="adminIndicator" class="hidden fixed top-20 right-6 z-50 px-4 py-2 rounded-lg bg-admin-accent text-white text-sm font-bold shadow-lg">
        <span class="material-symbols-outlined text-[16px] inline-block">shield</span>
        Admin Mode
    </div>

    <!-- Top Navigation -->
    <header
        class="sticky top-0 z-50 w-full border-b border-surface-border bg-background-dark/95 backdrop-blur-md px-6 py-3">
        <div class="mx-auto max-w-[1440px] flex items-center justify-between">
            <div class="flex items-center gap-3 text-white">
                <div id="logoClick" class="flex h-10 w-10 items-center justify-center rounded-xl bg-gradient-to-br from-primary to-purple-600 text-white cursor-pointer hover:scale-105 transition-transform shadow-lg shadow-primary/25">
                    <span class="material-symbols-outlined text-[24px]">theaters</span>
                </div>
                <h2 class="text-xl font-bold tracking-tight bg-gradient-to-r from-white to-purple-200 bg-clip-text text-transparent">MovieDB</h2>
            </div>
            <div class="flex items-center gap-4">
                <div class="hidden md:flex items-center gap-2 text-sm font-medium text-text-secondary">
                    <span id="navHome" class="text-white cursor-pointer hover:text-primary transition-colors">Home</span>
                    <span class="px-2">•</span>
                    <span id="adminLink" class="cursor-pointer hover:text-white transition-colors">Admin</span>
                    <span class="px-2">•</span>
                    <button id="pendingMoviesBtn" class="hidden relative cursor-pointer hover:text-white transition-colors">
                        <span>Pending</span>
                        <span id="pendingCount" class="hidden absolute -top-2 -right-3 flex h-5 w-5 items-center justify-center rounded-full bg-red-600 text-[10px] font-bold text-white">0</span>
                    </button>
                </div>
                <button id="settingsBtn"
                    class="flex h-10 w-10 items-center justify-center rounded-full bg-surface-dark hover:bg-surface-border text-white transition-colors">
                    <span class="material-symbols-outlined text-[20px]">settings</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="mx-auto flex w-full max-w-[1440px] grow flex-col px-6 py-6 md:px-8">
        <!-- Action & Stats Header -->
        <div class="mb-8 flex flex-col gap-6">
            <!-- Search & Add Row -->
            <div class="action-header-row flex flex-col md:flex-row gap-4 w-full">
                <!-- Search Bar -->
                <div class="relative flex grow">
                    <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-4">
                        <span class="material-symbols-outlined text-text-secondary">search</span>
                    </div>
                    <input id="searchInput"
                        class="block w-full rounded-xl border-none bg-surface-dark py-3.5 pl-12 pr-4 text-white placeholder-text-secondary focus:ring-2 focus:ring-primary"
                        placeholder="Search collection by title, director, or actor..." type="text" />
                </div>
                <!-- Add/Suggest Button (All Users) -->
                <button id="addMovieBtn"
                    class="flex shrink-0 items-center justify-center gap-2 rounded-xl bg-primary px-6 py-3.5 font-bold text-white shadow-lg shadow-primary/25 hover:bg-primary-hover transition-all active:scale-95">
                    <span class="material-symbols-outlined">add</span>
                    <span id="addMovieBtnText">Suggest Movie</span>
                </button>
            </div>

            <!-- Tabs & Stats Row -->
            <div
                class="stats-row flex flex-col md:flex-row items-start md:items-end justify-between border-b border-surface-border pb-1 gap-4">
                <!-- Tabs -->
                <div class="flex gap-8">
                    <button id="watchedTab" class="group relative flex flex-col items-center pb-3 tab-button active">
                        <span class="text-base font-bold text-white">Watched (<span id="watchedCount">0</span>)</span>
                        <span class="absolute bottom-0 h-0.5 w-full bg-transparent rounded-t-full transition-colors tab-indicator"></span>
                    </button>
                    <button id="watchlistTab" class="group relative flex flex-col items-center pb-3 tab-button">
                        <span
                            class="text-base font-bold text-text-secondary group-hover:text-white transition-colors">Watchlist
                            (<span id="watchlistCount">0</span>)</span>
                        <span
                            class="absolute bottom-0 h-0.5 w-full bg-transparent group-hover:bg-surface-border rounded-t-full transition-colors tab-indicator"></span>
                    </button>
                </div>
                <!-- Stats -->
                <div class="flex items-center gap-6 pb-3 text-sm">
                    <div class="flex items-center gap-2">
                        <span
                            class="flex h-8 w-8 items-center justify-center rounded-full bg-surface-dark text-secondary">
                            <span class="material-symbols-outlined text-[18px] fill-1">star</span>
                        </span>
                        <div class="flex flex-col">
                            <span id="avgRating" class="font-bold text-white text-base leading-none">-</span>
                            <span class="text-xs text-text-secondary">Avg Rating</span>
                        </div>
                    </div>
                    <div class="h-8 w-[1px] bg-surface-border"></div>
                    <div class="flex items-center gap-2">
                        <span
                            class="flex h-8 w-8 items-center justify-center rounded-full bg-surface-dark text-primary">
                            <span class="material-symbols-outlined text-[18px]">calendar_month</span>
                        </span>
                        <div class="flex flex-col">
                            <span id="monthCount" class="font-bold text-white text-base leading-none">0</span>
                            <span class="text-xs text-text-secondary">Watched this month</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Layout: Sidebar + Grid -->
        <div class="flex flex-col lg:flex-row gap-8">
            <!-- Mobile Filter Toggle -->
            <button class="mobile-filter-toggle lg:hidden" id="mobileFilterToggle">
                <span class="material-symbols-outlined">tune</span>
                <span>Filters</span>
            </button>

            <!-- Filter Backdrop (Mobile) -->
            <div class="filter-backdrop" id="filterBackdrop"></div>

            <!-- Sidebar (Filters) -->
            <aside class="filters-sidebar w-full lg:w-56 shrink-0 space-y-6 pl-0" id="filtersSidebar">
                <!-- Close button (Mobile only) -->
                <div class="filter-close-btn lg:hidden">
                    <h3 class="text-white font-bold text-lg">Filters</h3>
                    <button id="closeFiltersBtn">
                        <span class="material-symbols-outlined">close</span>
                        Close
                    </button>
                </div>

                <!-- Genre Filter -->
                <div class="filter-section collapsed" id="genreSection">
                    <div class="filter-section-header" onclick="toggleFilterSection('genreSection')">
                        <label class="filter-label">
                            <span class="material-symbols-outlined">category</span>
                            Genre
                        </label>
                        <span class="material-symbols-outlined collapse-icon">expand_more</span>
                    </div>
                    <div class="filter-section-content">
                        <div id="genreFilters" class="space-y-1.5">
                            <!-- Dynamically populated -->
                        </div>
                    </div>
                </div>

                <!-- Country Filter -->
                <div class="compact-filter space-y-2">
                    <label class="filter-label">
                        <span class="material-symbols-outlined">public</span>
                        Country
                    </label>
                    <div class="relative">
                        <select id="countryFilter"
                            class="w-full text-sm rounded-lg bg-surface-dark border-none text-white py-2 px-2.5 pr-8 focus:ring-1 focus:ring-primary cursor-pointer"
                            style="-webkit-appearance: none; -moz-appearance: none; appearance: none; background-image: none;">
                            <option value="">Any Country</option>
                        </select>
                        <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-text-secondary">
                            <span class="material-symbols-outlined text-sm">expand_more</span>
                        </div>
                    </div>
                </div>

                <!-- Decade Filter -->
                <div class="filter-section collapsed" id="decadeSection">
                    <div class="filter-section-header" onclick="toggleFilterSection('decadeSection')">
                        <label class="filter-label">
                            <span class="material-symbols-outlined">calendar_view_month</span>
                            Decade
                        </label>
                        <span class="material-symbols-outlined collapse-icon">expand_more</span>
                    </div>
                    <div class="filter-section-content">
                        <div id="decadeFilters" class="space-y-1.5">
                            <!-- Dynamically populated -->
                        </div>
                    </div>
                </div>

                <!-- Rating Slider -->
                <div class="compact-filter space-y-3">
                    <div class="flex justify-between items-center">
                        <label class="filter-label">
                            <span class="material-symbols-outlined">star</span>
                            Min Rating
                        </label>
                        <span id="ratingValue" class="text-xs font-mono text-primary bg-primary/10 px-2 py-0.5 rounded font-bold">0.0</span>
                    </div>
                    <input id="ratingFilter" type="range" min="0" max="10" step="0.1" value="0"
                        class="w-full h-2 bg-surface-border rounded-lg appearance-none cursor-pointer accent-primary">
                    <div class="flex justify-between text-xs text-text-secondary">
                        <span>0</span>
                        <span>5</span>
                        <span>10</span>
                    </div>
                </div>

                <!-- Clear Filters -->
                <button id="clearFilters"
                    class="w-full px-4 py-2.5 rounded-lg text-sm font-semibold text-white bg-surface-dark border border-surface-border hover:bg-primary hover:border-primary transition-all flex items-center justify-center gap-2">
                    <span class="material-symbols-outlined text-[18px]">filter_alt_off</span>
                    Clear Filters
                </button>
            </aside>

            <!-- Main Content -->
            <main class="flex-1 min-w-0">
                <!-- Grid Controls -->
                <div class="grid-controls-row flex flex-wrap items-center justify-between gap-4 mb-6">
                    <h3 id="resultCount" class="text-white text-lg font-medium">Showing 0 titles</h3>
                    <div class="flex items-center gap-3">
                        <button id="randomPick"
                            class="flex items-center gap-2 rounded-lg border border-surface-border px-4 py-2 text-sm font-semibold text-white hover:bg-surface-dark hover:border-text-secondary transition-colors">
                            <span class="material-symbols-outlined text-[18px]">shuffle</span>
                            Random Pick
                        </button>
                        <button id="exportData"
                            class="flex items-center gap-2 rounded-lg border border-surface-border px-4 py-2 text-sm font-semibold text-white hover:bg-surface-dark hover:border-text-secondary transition-colors">
                            <span class="material-symbols-outlined text-[18px]">download</span>
                            Export
                        </button>
                        <div class="relative">
                            <select id="sortSelect"
                                class="rounded-lg bg-surface-dark border border-surface-border text-white text-sm py-2 pl-4 pr-10 focus:ring-1 focus:ring-primary cursor-pointer hover:bg-surface-border/50 transition-colors"
                                style="-webkit-appearance: none; -moz-appearance: none; appearance: none; background-image: none;">
                                <option value="date_watched">Sort by: Date Watched</option>
                                <option value="admin_rating">Sort by: Admin Rating</option>
                                <option value="imdb_rating">Sort by: IMDb Rating</option>
                                <option value="date_added">Sort by: Date Added</option>
                                <option value="title">Sort by: Title (A-Z)</option>
                                <option value="year">Sort by: Year (Newest)</option>
                            </select>
                            <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-text-secondary">
                                <span class="material-symbols-outlined text-sm">sort</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Loading State -->
                <div id="loadingState" class="flex flex-col items-center justify-center py-20">
                    <div class="animate-spin rounded-full h-16 w-16 border-4 border-surface-border border-t-primary"></div>
                    <p class="mt-4 text-text-secondary">Loading your collection...</p>
                </div>

                <!-- Empty State -->
                <div id="emptyState" class="hidden flex flex-col items-center justify-center py-20">
                    <span class="material-symbols-outlined text-[80px] text-text-secondary mb-4">movie</span>
                    <h3 class="text-xl font-bold text-white mb-2">No movies found</h3>
                    <p class="text-text-secondary text-center max-w-md">
                        <span id="emptyStateMessage">Start building your collection by adding movies!</span>
                    </p>
                </div>

                <!-- Movie Grid -->
                <div id="movieGrid" class="hidden grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                    <!-- Movies will be dynamically inserted here -->
                </div>
            </main>
        </div>
    </div>

    <!-- Toast Notification Container -->
    <div id="toastContainer" class="fixed bottom-6 right-6 z-50 space-y-3">
        <!-- Toasts will be dynamically inserted here -->
    </div>

    <!-- Modals will be inserted here by JavaScript -->

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <!-- Application Scripts -->
    <script src="js/config.js"></script>
    <script src="js/firebase-db.js"></script>
    <script src="js/admin-auth.js"></script>
    <script src="js/api-service.js"></script>
    <script src="js/ui-components.js"></script>
    <script src="js/filters.js"></script>
    <script src="js/app.js"></script>
</body>

</html>
